;***********************************************************************************************
; 
; メイン → サブプロセス用の処理
; 
;***********************************************************************************************
;***********************************************************************************************
; サブプロセス側の処理を起動するための関数
;***********************************************************************************************
;-----------------------------------------------------------------------
; サブプロセスへのメッセージ送信
;-----------------------------------------------------------------------
SendMessageToSubProcess(msg, wParam = 0, lParam = 0) {
	Prev_DetectHiddenWindows := A_DetectHiddenWindows
	Prev_TitleMatchMode := A_TitleMatchMode
	DetectHiddenWindows On
	SetTitleMatchMode 2
	SendMessage, %msg%, %wParam%, %lParam%, , SubProcess.ahk ahk_class AutoHotkey
	DetectHiddenWindows %Prev_DetectHiddenWindows%
	SetTitleMatchMode %Prev_TitleMatchMode%
}

;-----------------------------------------------------------------------
; サブプロセスを終了する
;-----------------------------------------------------------------------
ExitSubProcess() {
	Send, {vk3B}
}

;-----------------------------------------------------------------------
; ポップアップランチャー起動
;-----------------------------------------------------------------------
; "C": キャレット位置
; "M": マウスカーソル位置
PopupLauncher(Pos) {
	if (Pos = "C") {
		Send, {vk07}
	}
	else {
		Send, {vk0E}
	}
}

;-----------------------------------------------------------------------
; テキストバッファ起動
;-----------------------------------------------------------------------
; "C": キャレット位置
; "M": マウスカーソル位置
TextBuffer(Pos) {
	if (Pos = "C") {
		Send, {vk0F}
	}
	else {
		Send, {vk16}
	}
}

;-----------------------------------------------------------------------
; クリップボード履歴起動
;-----------------------------------------------------------------------
; "C": キャレット位置
; "M": マウスカーソル位置
ClipboardHistory(Pos) {
	if (Pos = "C") {
		Send, {vk1A}
	}
	else {
		Send, {vk3A}
	}
}

;***********************************************************************************************
; インクルード
;***********************************************************************************************
